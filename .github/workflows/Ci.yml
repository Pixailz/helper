name: CI

run-name: Full helper CI/CD

on:
  push:
    branches: [main]
    # paths:
    #   - 'helper'
    #   - 'modules/**/**.py'
  pull_request:
    types: [opened]

jobs:
  # info:
  #   runs-on: ubuntu-latest
  #   steps:
  #     - name: "github"
  #       run: |+
  #         echo "Who launched: ${{github.actor}}"
  #         echo "On branch:    ${{github.ref_name}}"
  #         echo "Commit sha:   ${{github.sha}}"

  #     - name: "Bin utils"
  #       run: |+
  #         make --version && echo
  #         ar --version && echo
  #         gcc --verbose && echo
  #         python3 --version

  test:
    runs-on: ubuntu-latest
    steps:
      - name: Retrieve all repo
        run: |+
          mkdir test && cd test
          git clone https://github.com/Pixailz/ft_libft
          rm -rf ft_libft/rsc/helper
          git clone https://github.com/Pixailz/helper ft_libft/rsc/helper
          git clone https://github.com/Pixailz/ft_ping
          rm -rf ft_ping/lib/ft_libft
          cp -r {,ft_ping/lib/}ft_libft
          git clone https://github.com/Pixailz/SupaBlank
          rm -rf SupaBlank/{lib/ft_libft,rsc/helper}
          cp -r {,SupaBlank/lib/}ft_libft
          cp -r SupaBlank/{lib/ft_libft/rsc/helper,rsc/helper}

      - name: intermediary step
        run:
          pwd && ls -laR ..

      - name: test ft_libft
        run: make -C ft_libft

      - name: test ft_libft
        run: make -C ft_ping

      - name: test ft_libft
        run: make -C SupaBlank
